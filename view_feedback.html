<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Adopto â€” View Feedback</title>
  <link rel="icon" href="images/favicon.ico" type="image/x-icon">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Merriweather:wght@700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <div class="container">
            <div class="logo">
                <a href="index.html">Adopto</a>
            </div>
            <nav>
                <a href="index.html">Home</a>
                <a href="adoption.html">Adoption</a>
                <a href="helpinghands.html">Helpful Hands</a>
                <a href="contact.html">Contact</a>
            </nav>
        </div>
    </header>

    <main>
        <section class="view-feedback-section">
            <div class="container">
                <h2>What Others Are Saying</h2>
                <div id="feedback-list" class="feedback-list">
                    <!-- Feedback will be loaded here dynamically -->
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 Adopto. All rights reserved.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            fetch('http://localhost:3000/feedbacks')
                .then(response => response.json())
                .then(data => {
                    const feedbackList = document.getElementById('feedback-list');
                    if (!data || data.length === 0) {
                        feedbackList.innerHTML = '<p>No feedback yet. Be the first to share your thoughts!</p>';
                        return;
                    }
                    
                    // Sort feedback by ID in descending order to show newest first
                    data.sort((a, b) => b.id - a.id);

                    feedbackList.innerHTML = ''; // Clear existing content
                    data.forEach(feedback => {
                        const feedbackItem = document.createElement('div');
                        feedbackItem.className = 'feedback-item';

                        let imageHTML = '';
                        if (feedback.image_path) {
                            // Ensure the path is correct for web access
                            const imagePath = feedback.image_path.replace(/\\/g, '/');
                            imageHTML = `<img src="http://localhost:3000/${imagePath}" alt="Feedback image" style="max-width: 100%; border-radius: 8px; margin-top: 10px;">`;
                        }

                        feedbackItem.innerHTML = `
                            <h3>${feedback.name}</h3>
                            <p>"${feedback.feedback}"</p>
                            ${imageHTML}
                        `;
                        feedbackList.appendChild(feedbackItem);
                    });
                })
                .catch(error => {
                    console.error('Error fetching feedback:', error);
                    const feedbackList = document.getElementById('feedback-list');
                    feedbackList.innerHTML = '<p>Could not load feedback at this time.</p>';
                });
        });
    </script>
</body>
</html>